Most of this is shamelessly copied from Fedora's kobo

See: kobo/django/auth
